<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refactor Kritter Object</title>
    <style>
        .container {
            background: url('../../photos/city_6.jpg');
            background-size: contain;
            background-repeat: no-repeat;
            width: 700px;
            height: 933px;
            /* position: relative;
            display: inline-block; */
        }

        use{
            /* position: absolute; */
            border: solid red 4px;
        }
        #cord_displays{
            height: 3em;
            position: absolute;
            margin-left: 2em;
            top: 20px;
            border: solid rebeccapurple 5px;
        }
    </style>
</head>

<body>
    <svg id="main_svg" display="none">
        <symbol stroke='black' id="whole_figure">
            <g id="whole_figure_group">
                <!-- <svg id="whole_figure" viewBox="0 0 356.84 541.83"> -->
                <path class="cls-1"
                    d="M97.47,32.82a53.71,53.71,0,0,1,16.2-16.13,64.45,64.45,0,0,1,8-4.45,86.65,86.65,0,0,1,8.14-3.05c.38-.11.81-.26,1.24-.37A68.7,68.7,0,0,1,138.72,7h.06c2.93-.52,14-2.74,25.74-1.5a49.9,49.9,0,0,1,12.11,2.73A31.94,31.94,0,0,1,187,14.45c12.43,11.48,7.05,26.41,27.18,61,5.67,9.72,5.9,8.2,12.48,19.1C233,105,239,115,243.73,124.55c4.25,8.57,7.42,16.8,8.71,24.62a44.92,44.92,0,0,1,.64,9.93C251,196,196.79,219.3,179.65,226.66c-2.65,1.15-5.9,2.53-9.67,3.94-.8.32-1.64.63-2.47,1a3,3,0,0,1-.37.14c-.75.26-1.5.52-2.25.81-1,.34-2,.69-3,1-1.81.61-3.68,1.18-5.66,1.76-1,.31-2.08.63-3.14.89s-2.07.57-3.13.83a144.63,144.63,0,0,1-26,4.09c-1,.05-1.93.11-2.91.14h0l-2.18.09c-4.06.08-8.26,0-12.57-.32a128.33,128.33,0,0,1-21.31-3.34c-10.64-2.58-70.06-21.88-75.65-57.26C6.81,164.86,15.8,152.81,30.57,132,47.09,108.61,70,75.39,97.47,32.82Z"
                    transform="translate(-2.61 -3.67)" />
                <g>
                    <path class="cls-1"
                        d="M318.19,469.12c-2.5,2.88-5.15,5.7-7.91,8.46a26.19,26.19,0,0,0-4.48-15.33c-.81-1.15-4.81-11.48-16.23-9.64-9.06,1.44-11.59,11.28-13,19.59-2,11.93-1.06,14.64-4.17,24.7a12,12,0,0,1-.6,1.56c-.17.34-.35.69-.55,1l-.11.2-.4.58c-.23.34-.46.66-.72,1a16,16,0,0,1-1.1,1.21s0,.05-.05.05c-.41.41-.81.78-1.24,1.15,0,0-.09.06-.12.12-.4.31-.83.63-1.23,1a30.41,30.41,0,0,1-2.85,1.81c-.49.29-.95.55-1.44.78-1.12.57-2.24,1.06-3.25,1.49l-1.47.58c-1.43.51-2.64.89-3.42,1.15h0l-.31.08-.26.09a1.46,1.46,0,0,0-.32.09c-14.84,5.66-14.58,5.29-20.48,10.24a122.36,122.36,0,0,1-32.5,2.79c-49.73-2.65-101.27-38.8-112.57-75a45.42,45.42,0,0,1-2-19,39.53,39.53,0,0,1,4-13.11,58.54,58.54,0,0,1,13.15-16.86,64.28,64.28,0,0,0,8.57,8.49c1,.86,2.1,1.69,3.19,2.5,1.44,1.09,2.93,2.1,4.43,3.08.75.49,1.5,1,2.27,1.43.18.12.35.23.52.32,1,.61,2,1.18,3,1.73,2.3,1.29,4.66,2.47,7,3.56,1.09.52,2.16,1,3.25,1.47.86.37,1.7.72,2.56,1.06s1.55.64,2.33.92c1.61.64,3.25,1.24,4.89,1.79.95.34,1.87.66,2.82,1,1.12.37,2.24.72,3.33,1q3.28,1,6.53,1.84c1.18.35,2.33.64,3.48.89s2.5.61,3.77.87c1.75.4,3.51.75,5.21,1.09s3.39.63,5,.92c.63.12,1.27.2,1.87.32,4.34.69,8.28,1.21,11.68,1.61l1.92.2c.41,0,.78.06,1.15.11.55.06,1.1.09,1.59.15.69.08,1.35.14,2,.17a1.75,1.75,0,0,1,.4,0c.87.09,1.64.14,2.31.17l1.69.09a6.45,6.45,0,0,0,.69.06c1.38.05,6,.2,13-.12.58,0,1.18-.06,1.79-.11.37,0,.8,0,1.21-.06.83-.06,1.69-.12,2.56-.2,5.4-.41,11.73-1.12,18.63-2.3l3.57-.67c2.07-.4,4.17-.83,6.33-1.32,3.59-.8,7.3-1.75,11.07-2.87l2.27-.69q4.62-1.39,9.32-3.17c1.53-.55,3-1.15,4.55-1.75s3.1-1.3,4.65-2,3.14-1.41,4.69-2.18c.78-.38,1.56-.75,2.3-1.15,1.56-.81,3.11-1.61,4.66-2.48a10,10,0,0,0,.9-.49s.05,0,.05,0a71.58,71.58,0,0,0,16.91-8.31,51.09,51.09,0,0,0,17.55-20l0,0c1.67-1.92,3.25-3.94,4.8-6,5.75,6.07,10.21,13.23,12.14,21.63C347.5,422.38,337.23,447.15,318.19,469.12Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-1"
                        d="M310.25,241.87a98.84,98.84,0,0,1-16.39,21.69,68.59,68.59,0,0,0-2.24-14.12c-1.53-5.64-7.8-28.79-27-35.44-1.44-.49-17.4-5.78-26.26,3.11-7,7.07-6.27,19.76-2.19,27.93,5.87,11.73,16.83,10.5,20.57,21.28,3.59,10.47-3.34,21.49-3.94,22.41-8.63,13.28-24.77,12.88-31.44,18.81-10.07,3.33-32.9,10.06-55.86,9.95-15.9-.09-31.89-3.45-43.71-13.52a43.12,43.12,0,0,1-5.32-5.32,46.39,46.39,0,0,1-7.57-12.43c-4.74-11.24-5.26-23.52-4.37-33.79A114.75,114.75,0,0,1,106.22,241c4.31.32,8.51.4,12.57.32l2.18-.09h0c1,0,2-.09,2.91-.14a144.63,144.63,0,0,0,26-4.09c1.06-.26,2.1-.54,3.13-.83s2.1-.58,3.14-.89c2-.58,3.85-1.15,5.66-1.76,1-.34,2-.69,3-1,.75-.29,1.5-.55,2.25-.81a3,3,0,0,0,.37-.14c.83-.32,1.67-.61,2.47-.92v0c3.77-1.41,7-2.79,9.67-3.94C196.79,219.3,251,196,253.08,159.1a44.92,44.92,0,0,0-.64-9.93c12.66,1.67,24.42,5.61,34.4,12.14,2.76,1.81,28,18.87,30.86,47C318.91,220.07,316,231.35,310.25,241.87Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-1"
                        d="M336.05,373.06c-1.69,2.7-3.45,5.26-5.29,7.73-1.55,2.1-3.13,4.12-4.8,6,4.94-10,6.67-21.22,6.18-31.89-.26-5.38,2.1-28.71-13.83-38.52-1.21-.74-9-8.6-18.73-2.35-7.7,4.94-9.6,16.07-7.59,24.21,2.93,11.77,2.79,13.78,4,24.25,1.15,10.12-11.82,22.06-12.54,22.75-12.45,12.22-21.37.69-26,10-2.7,5.35.6,13.32,5,17.52,6.87,6.58,18.26,6,29.05,2.41a10,10,0,0,1-.9.49c-1.55.87-3.1,1.67-4.66,2.48-.74.4-1.52.77-2.3,1.15-1.55.77-3.13,1.49-4.69,2.18s-3.1,1.35-4.65,2-3,1.2-4.55,1.75q-4.69,1.77-9.32,3.17l-2.27.69c-3.77,1.09-7.45,2-11.07,2.87-2.16.49-4.26.92-6.33,1.32l-3.57.67c-6.9,1.18-13.23,1.89-18.63,2.3-.87.08-1.73.14-2.56.2-.41,0-.84.06-1.21.06-.61,0-1.21.08-1.79.11-6.93.32-11.59.17-13,.12a6.45,6.45,0,0,1-.69-.06l-1.69-.09c-.67-.06-1.44-.11-2.31-.17a1.75,1.75,0,0,0-.4,0l-2-.17c-.49-.06-1-.09-1.59-.15-.37-.05-.74-.08-1.15-.11l-1.92-.2c-3.4-.4-7.34-.92-11.68-1.61-.6-.12-1.24-.2-1.87-.32-1.61-.29-3.28-.57-5-.92s-3.46-.69-5.21-1.09c-1.27-.26-2.5-.58-3.77-.87s-2.3-.57-3.48-.89q-3.24-.81-6.53-1.84c-1.09-.31-2.21-.66-3.33-1-.95-.29-1.87-.61-2.82-1-1.64-.55-3.28-1.15-4.89-1.79-.78-.28-1.56-.6-2.33-.92s-1.7-.69-2.56-1.06c-1.09-.46-2.16-.95-3.25-1.47-2.39-1.09-4.75-2.27-7-3.56-1-.55-2-1.12-3-1.73-.17-.09-.34-.2-.52-.32-.77-.46-1.52-.94-2.27-1.43-1.5-1-3-2-4.43-3.08-1.09-.81-2.16-1.64-3.19-2.5a64.28,64.28,0,0,1-8.57-8.49,53.61,53.61,0,0,1-10.27-19,56.73,56.73,0,0,1-1.67-7.45v0a70.94,70.94,0,0,1,4.06-35.75c3.39-8.77,8.51-16.65,15.24-22.38,3.8-3.22,5.44-6.61,11.94-11.3,11.82,10.07,27.81,13.43,43.71,13.52,23,.11,45.79-6.62,55.86-9.95a8.31,8.31,0,0,0-2.7,4.31c-1.61,6.3,3.79,14,9.43,17.37C242,337.65,264.9,325,277,312.34c13-13.63,17.86-32,16.91-48.78a98.84,98.84,0,0,0,16.39-21.69C326,247.8,340,257.69,348.79,272.19,373.67,313.26,340.8,365.52,336.05,373.06Z"
                        transform="translate(-2.61 -3.67)" />
                </g>
                <g>
                    <path class="cls-2"
                        d="M310.28,477.58c0,11.36-5.86,22.09-7.19,25.51a66.26,66.26,0,0,1-16.42,25,51.35,51.35,0,0,1-26.09,13.09c-15.82,2.87-27.21,7.25-33-6.56-2.33-5.61-1.7-8.17,2.94-12l1.89-1.58c5.9-4.95,5.64-4.58,20.48-10.24a1.46,1.46,0,0,1,.32-.09l.26-.09.31-.08h0c.78-.26,2-.64,3.42-1.15l1.47-.58c1-.43,2.13-.92,3.25-1.49.49-.23.95-.49,1.44-.78a30.41,30.41,0,0,0,2.85-1.81c.4-.32.83-.64,1.23-1,0-.06.09-.09.12-.12.43-.37.83-.74,1.24-1.15,0,0,0,0,.05-.05a16,16,0,0,0,1.1-1.21c.26-.32.49-.64.72-1l.4-.58.11-.2c.2-.34.38-.69.55-1a12,12,0,0,0,.6-1.56c3.11-10.06,2.16-12.77,4.17-24.7,1.41-8.31,3.94-18.15,13-19.59,11.42-1.84,15.42,8.49,16.23,9.64A26.19,26.19,0,0,1,310.28,477.58Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-2"
                        d="M108.92,286.22c-27.47-9.66-41.33-6.24-49-.31-9.49,7.33-10.87,19.61-27.41,29.36-2.47,1.47-16.08,9.49-21.54,4.89-6.24-5.23,1.78-23.81,2.93-26.43,7.91-17.83,27-39.26,55.8-44.06a74,74,0,0,1,34.83,2.76C103.66,262.7,104.18,275,108.92,286.22Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-2"
                        d="M90.57,373.4c-16.8-3.68-27.21-.83-35.52.15s-16.16,7.24-28.39,13.2c-1.35.66-16.42,6.87-20.56,0-5.52-9.09,16-31.9,41.13-43.09a82.55,82.55,0,0,1,47.4-6A70.94,70.94,0,0,0,90.57,373.4Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-2"
                        d="M87.38,448.79c-7.71-2.39-16.88-3.66-26.46-1.33C49.84,450.14,40.76,457,36.44,460.2c-14.72,11.05-18,20.71-23.5,19.56-5.89-1.21-10-13.77-8.8-24.47,2.33-20.89,25.17-36.19,44.07-41.1,16.73-4.38,31.69-.95,41.15,2.53a39.53,39.53,0,0,0-4,13.11A45.42,45.42,0,0,0,87.38,448.79Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-1"
                        d="M277,312.34c-12.05,12.66-35,25.31-48.84,16.88-5.64-3.39-11-11.07-9.43-17.37a8.31,8.31,0,0,1,2.7-4.31c6.67-5.93,22.81-5.53,31.44-18.81.6-.92,7.53-11.94,3.94-22.41-3.74-10.78-14.7-9.55-20.57-21.28-4.08-8.17-4.8-20.86,2.19-27.93,8.86-8.89,24.82-3.6,26.26-3.11,19.18,6.65,25.45,29.8,27,35.44a68.59,68.59,0,0,1,2.24,14.12C294.81,280.33,289.92,298.71,277,312.34Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-1"
                        d="M326,386.83l0,0a51.09,51.09,0,0,1-17.55,20,71.58,71.58,0,0,1-16.91,8.31s0,0-.05,0c-10.79,3.6-22.18,4.17-29.05-2.41-4.38-4.2-7.68-12.17-5-17.52,4.66-9.26,13.58,2.27,26-10,.72-.69,13.69-12.63,12.54-22.75-1.18-10.47-1-12.48-4-24.25-2-8.14-.11-19.27,7.59-24.21,9.75-6.25,17.52,1.61,18.73,2.35,15.93,9.81,13.57,33.14,13.83,38.52C332.63,365.61,330.9,376.82,326,386.83Z"
                        transform="translate(-2.61 -3.67)" />
                </g>
                <g>
                    <path class="cls-1"
                        d="M161.64,151s-3.29,15.44-19.63,19.86-69.5-1.36-86.78-11.62L38,149h0l-2.2,13.59-1.48,4A18.68,18.68,0,0,1,42,172c2.87,3.8,1.82,4.73,1.82,4.73s20.71,9.45,20.69,12.49l0,3s21.08,3.12,22.88,7,1.25,4,1.25,4,17.17-1.45,19.61,3.1,3.11,3.72,3.11,3.72,22.81,4.34,25.31,1.07a5.67,5.67,0,0,0,.85-5.56S146,217.66,156,207.77s11.15-9.33,11.15-9.33,9.67-9.22,9.84-13.41,2.76-5,2.76-5,3.13-8.67,2.77-10.47,1.82-3.4.85-6.91-4.5-11.91-12.22-11.92A86.67,86.67,0,0,0,161.64,151Z"
                        transform="translate(-2.61 -3.67)" />
                    <line class="cls-1" x1="50.31" y1="154.17" x2="48.66" y2="176.69" />
                    <line class="cls-1" x1="74.43" y1="163.09" x2="72.29" y2="190.6" />
                    <line class="cls-1" x1="103" y1="167.6" x2="104.04" y2="201.34" />
                    <line class="cls-1" x1="128.59" y1="168.56" x2="134.91" y2="202.04" />
                    <line class="cls-1" x1="148.38" y1="162.91" x2="164.49" y2="194.77" />
                    <line class="cls-1" x1="156.72" y1="153.2" x2="175.49" y2="177.64" />
                    <line class="cls-1" x1="160.23" y1="147.87" x2="179.86" y2="165.9" />
                </g>
                <g>
                    <path class="cls-1"
                        d="M172.09,93.15a130.14,130.14,0,0,0-33.22-26.86,132.29,132.29,0,0,0-26.35-11.5,123.49,123.49,0,0,0-12.45-3.2c-2.68-.54-5.35-1-8.06-1.38-.11,0-.26,0-.37-.05.43-.7.86-1.39,1.29-2s1-1.58,1.53-2.33c12.68-18.66,30.92-31.12,44.84-28C159.32,22.29,176,60.22,172.09,93.15Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-1"
                        d="M172.09,93.15c-1.38,11.88-5.41,23.07-13,31.84-12.68,14.79-38.34,26.21-58,16.17-11-5.61-16.57-16.08-19.33-26.64-3.82-14.64-2.21-29.39-2-31.37.11-.87.23-1.76.37-2.62.09-.61.2-1.21.32-1.79a75.28,75.28,0,0,1,2.85-10.87c.23-.72.48-1.41.74-2.13.09-.25.18-.48.29-.74.37-1,.78-2,1.18-3a1,1,0,0,1,.12-.23c.46-1.12.94-2.21,1.46-3.27a88.35,88.35,0,0,1,4.49-8.37c.11,0,.26,0,.37.05,2.71.38,5.38.84,8.06,1.38a123.49,123.49,0,0,1,12.45,3.2,132.29,132.29,0,0,1,26.35,11.5A130.14,130.14,0,0,1,172.09,93.15Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-1"
                        d="M94.46,45.78c-.52.78-1,1.53-1.53,2.33s-.86,1.35-1.29,2a88.35,88.35,0,0,0-4.49,8.37c-.52,1.06-1,2.15-1.46,3.27a1,1,0,0,0-.12.23c-.4,1-.81,2-1.18,3-.11.26-.2.49-.29.74a90.24,90.24,0,0,0-38.74-9.11c-4.49,0-9.09.31-13.23,2A14.93,14.93,0,0,0,25.89,64a17,17,0,0,0-2.65,5.29,94.39,94.39,0,0,1,1.5-10.38C28.42,42.25,40.85,14.66,60,14.12c9.32-.26,17.11,6,22.21,11.53a66.85,66.85,0,0,1,6.06,7.79A56.57,56.57,0,0,1,94.46,45.78Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-1"
                        d="M79.82,83.15c-.23,2-1.84,16.73,2,31.37a33.82,33.82,0,0,1-5.63,3.86c-10.45,5.69-25,6.5-36,0a30.86,30.86,0,0,1-11.39-12c-6.44-11.76-6.47-27.09-5.55-37.13A17,17,0,0,1,25.89,64a14.93,14.93,0,0,1,6.24-5.32c4.14-1.73,8.74-2.07,13.23-2A90.24,90.24,0,0,1,84.1,65.74c-.26.72-.51,1.41-.74,2.13a75.28,75.28,0,0,0-2.85,10.87c-.12.58-.23,1.18-.32,1.79C80.05,81.39,79.93,82.28,79.82,83.15Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-3"
                        d="M138.87,66.29c-1.47,13.23-12.06,23.5-24.91,23.5-13.84,0-25.08-11.94-25.08-26.69A27.68,27.68,0,0,1,92,50.21c2.71.38,5.38.84,8.06,1.38a123.49,123.49,0,0,1,12.45,3.2A132.29,132.29,0,0,1,138.87,66.29Z"
                        transform="translate(-2.61 -3.67)" />
                    <path class="cls-3"
                        d="M61.58,66.35a17.93,17.93,0,0,1-35.86,0A15.34,15.34,0,0,1,25.89,64a14.93,14.93,0,0,1,6.24-5.32c4.14-1.73,8.74-2.07,13.23-2a90.48,90.48,0,0,1,14.09,1.23A17.84,17.84,0,0,1,61.58,66.35Z"
                        transform="translate(-2.61 -3.67)" />
                    <circle class="cls-4" cx="37.2" cy="60.97" r="6.47" />
                    <path class="cls-4"
                        d="M113.27,58.18a8.23,8.23,0,1,1-13.2-6.59,123.49,123.49,0,0,1,12.45,3.2A7.86,7.86,0,0,1,113.27,58.18Z"
                        transform="translate(-2.61 -3.67)" />
                </g>
            </g>
        </symbol>
    </svg>
    <div class="container">
        <svg id="use_box" width="700px" height="933px" viewBox="0 0 700 933"></svg>
    </div>
    <script src="perpetually_blank.js"></script>
    <script>
        let fingarin = new NewKritter('fingarin');
        fingarin.drawNow();
        let scaleFactor = .25;
        fingarin.resetViewbox(`0 -500 ${700/scaleFactor} ${933/scaleFactor}`);

        let useElement = document.getElementById('fingarin_use_element');
        let wholeFig = document.getElementById('fingarin_whole_figure');
        useElement.style.transformOrigin = '150px';//seems to need to be set on the use element and not the symbol to be effective
        // useElement.style.transform = `scale(${-scaleFactor}, ${scaleFactor})`;

        let parkey = new NewKritter('parkey');
        parkey.drawNow();
        parkey.resetViewbox(`-300 -200 ${700/scaleFactor} ${933/scaleFactor}`);

        let hovering = false,
            dragging = false,
            cursorOnCharX = 0,
            cursorOnCharY = 0;

        let pue = parkey.useElement;
        //this will append the input elements that actually output values for our rects
        document.getElementById('use_box').insertAdjacentElement('afterend', parkey.rectBuddy);

        pue.addEventListener('mouseenter', ()=>{
            hovering = true;
            console.log(hovering);
        });
        pue.addEventListener('mouseleave', ()=>{
            hovering = false;
            console.log(hovering);

        });

        pue.onmousedown = function (e) {
            //get offset of cursor from left edge of box
            dragging = true;
            if(hovering === true){
                cursorOnCharX = (e.offsetX - pue.getBBox().x)/scaleFactor;
                cursorOnCharY = (e.offsetY - pue.getBBox().y)/scaleFactor;
                // cursorOnCharX = (e.offsetX - pue.getBoundingClientRect().x)/scaleFactor;
                // cursorOnCharY = (e.offsetY - pue.getBoundingClientRect().y)/scaleFactor;
            }

            function onMouseMove(e) {
                parkey.resetViewbox(`${-(e.offsetX/scaleFactor - cursorOnCharX)} 
                                     ${-(e.offsetY/scaleFactor - cursorOnCharY)} 
                                     ${700/scaleFactor} 
                                     ${933/scaleFactor}`);
                console.log(`cursorOnCharX is ${cursorOnCharX}`);
                //update data for rect x displays
                document.getElementById('rectX').setAttribute('value', pue.getBoundingClientRect().x);
                document.getElementById('offsetX').setAttribute('value', e.offsetX);
                document.getElementById('bboxX').setAttribute('value', pue.getBBox().x);

            }

            //set pue's x property to x.offset - cursorOnCharX
            pue.addEventListener('mousemove', onMouseMove);

            pue.onmouseup = function () {
                pue.removeEventListener('mousemove', onMouseMove);
                pue.onmouseup = null;
                dragging = false;
                console.log("IN ON MOUSE UP");
            }

            // pue.ondragstart = function () {
            //     return false;
            // };
        }



    </script>
</body>

</html>